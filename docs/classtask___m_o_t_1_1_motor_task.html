<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ROMI Search &amp; Rescue: task_MOT.MotorTask Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ROMI Search &amp; Rescue
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>task_MOT</b></li><li class="navelem"><a class="el" href="classtask___m_o_t_1_1_motor_task.html">MotorTask</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classtask___m_o_t_1_1_motor_task-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">task_MOT.MotorTask Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This file implement a task that control ROMI motor base on input share from different task.  
 <a href="classtask___m_o_t_1_1_motor_task.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a56a41a5ee208a286b759673e26174c44" id="r_a56a41a5ee208a286b759673e26174c44"><td class="memItemLeft" align="right" valign="top"><a id="a56a41a5ee208a286b759673e26174c44" name="a56a41a5ee208a286b759673e26174c44"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>__init__</b> (self, <a class="el" href="classtask___m_o_t_1_1_motor_task.html#ac0fd51beb5ba9eaba64707d74f2affd1">SER_DIR</a>, <a class="el" href="classtask___m_o_t_1_1_motor_task.html#a213f7376486aad8f102c11546b138424">IMU_YAW</a>, <a class="el" href="classtask___m_o_t_1_1_motor_task.html#a05fac53f43a57faa854943d6dbc0a985">ULS_DIS</a>, <a class="el" href="classtask___m_o_t_1_1_motor_task.html#a3147afb61fa73184807ed3993373524d">CLOSE</a>)</td></tr>
<tr class="separator:a56a41a5ee208a286b759673e26174c44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56c3f12f721ec1d5d83378d95dcb96a1" id="r_a56c3f12f721ec1d5d83378d95dcb96a1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtask___m_o_t_1_1_motor_task.html#a56c3f12f721ec1d5d83378d95dcb96a1">run</a> (self)</td></tr>
<tr class="separator:a56c3f12f721ec1d5d83378d95dcb96a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a3147afb61fa73184807ed3993373524d" id="r_a3147afb61fa73184807ed3993373524d"><td class="memItemLeft" align="right" valign="top"><a id="a3147afb61fa73184807ed3993373524d" name="a3147afb61fa73184807ed3993373524d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>CLOSE</b></td></tr>
<tr class="memdesc:a3147afb61fa73184807ed3993373524d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Share that use to close or open the blindfold. <br /></td></tr>
<tr class="separator:a3147afb61fa73184807ed3993373524d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0fd51beb5ba9eaba64707d74f2affd1" id="r_ac0fd51beb5ba9eaba64707d74f2affd1"><td class="memItemLeft" align="right" valign="top"><a id="ac0fd51beb5ba9eaba64707d74f2affd1" name="ac0fd51beb5ba9eaba64707d74f2affd1"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>SER_DIR</b></td></tr>
<tr class="memdesc:ac0fd51beb5ba9eaba64707d74f2affd1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Share that implement servo angle that connecto the ultrasonic sensor. <br /></td></tr>
<tr class="separator:ac0fd51beb5ba9eaba64707d74f2affd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05fac53f43a57faa854943d6dbc0a985" id="r_a05fac53f43a57faa854943d6dbc0a985"><td class="memItemLeft" align="right" valign="top"><a id="a05fac53f43a57faa854943d6dbc0a985" name="a05fac53f43a57faa854943d6dbc0a985"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ULS_DIS</b></td></tr>
<tr class="memdesc:a05fac53f43a57faa854943d6dbc0a985"><td class="mdescLeft">&#160;</td><td class="mdescRight">Share that store the distance that the ultrasonic sensor read in [cm]. <br /></td></tr>
<tr class="separator:a05fac53f43a57faa854943d6dbc0a985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a213f7376486aad8f102c11546b138424" id="r_a213f7376486aad8f102c11546b138424"><td class="memItemLeft" align="right" valign="top"><a id="a213f7376486aad8f102c11546b138424" name="a213f7376486aad8f102c11546b138424"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>IMU_YAW</b></td></tr>
<tr class="memdesc:a213f7376486aad8f102c11546b138424"><td class="mdescLeft">&#160;</td><td class="mdescRight">IMU yaw angle [rad] that is share with task_MOT. <br /></td></tr>
<tr class="separator:a213f7376486aad8f102c11546b138424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2207cde7973ee75a76a310a4571d933d" id="r_a2207cde7973ee75a76a310a4571d933d"><td class="memItemLeft" align="right" valign="top"><a id="a2207cde7973ee75a76a310a4571d933d" name="a2207cde7973ee75a76a310a4571d933d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>DIST_PATH</b></td></tr>
<tr class="memdesc:a2207cde7973ee75a76a310a4571d933d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simutaneous small linear distance to keep track of ROMI global coordinate locations. <br /></td></tr>
<tr class="separator:a2207cde7973ee75a76a310a4571d933d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d688b1b058bec110d0efaa2e289d27b" id="r_a7d688b1b058bec110d0efaa2e289d27b"><td class="memItemLeft" align="right" valign="top"><a id="a7d688b1b058bec110d0efaa2e289d27b" name="a7d688b1b058bec110d0efaa2e289d27b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>X</b></td></tr>
<tr class="memdesc:a7d688b1b058bec110d0efaa2e289d27b"><td class="mdescLeft">&#160;</td><td class="mdescRight">X-Coordinate. <br /></td></tr>
<tr class="separator:a7d688b1b058bec110d0efaa2e289d27b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbb34f1d94a1327a29a32394b48660dc" id="r_abbb34f1d94a1327a29a32394b48660dc"><td class="memItemLeft" align="right" valign="top"><a id="abbb34f1d94a1327a29a32394b48660dc" name="abbb34f1d94a1327a29a32394b48660dc"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>Y</b></td></tr>
<tr class="memdesc:abbb34f1d94a1327a29a32394b48660dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Y-Coordinate. <br /></td></tr>
<tr class="separator:abbb34f1d94a1327a29a32394b48660dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeedea1b2bd9cbd883a5a6c20f8470925" id="r_aeedea1b2bd9cbd883a5a6c20f8470925"><td class="memItemLeft" align="right" valign="top"><a id="aeedea1b2bd9cbd883a5a6c20f8470925" name="aeedea1b2bd9cbd883a5a6c20f8470925"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>WALL</b></td></tr>
<tr class="memdesc:aeedea1b2bd9cbd883a5a6c20f8470925"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag that is 1 if already pass the wall and 0 otherwise. <br /></td></tr>
<tr class="separator:aeedea1b2bd9cbd883a5a6c20f8470925"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abca0928d893d0ef0d770f9690859f2f8" id="r_abca0928d893d0ef0d770f9690859f2f8"><td class="memItemLeft" align="right" valign="top"><a id="abca0928d893d0ef0d770f9690859f2f8" name="abca0928d893d0ef0d770f9690859f2f8"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>TARGET</b></td></tr>
<tr class="memdesc:abca0928d893d0ef0d770f9690859f2f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag that is 1 if already stop at the target spot and 0 otherwise. <br /></td></tr>
<tr class="separator:abca0928d893d0ef0d770f9690859f2f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a091ffc6a1424b2dd0a2dc2d4d962d1f0" id="r_a091ffc6a1424b2dd0a2dc2d4d962d1f0"><td class="memItemLeft" align="right" valign="top"><a id="a091ffc6a1424b2dd0a2dc2d4d962d1f0" name="a091ffc6a1424b2dd0a2dc2d4d962d1f0"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>HOME</b></td></tr>
<tr class="memdesc:a091ffc6a1424b2dd0a2dc2d4d962d1f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag that is 1 if already sucessfully return home and 0 otherwise. <br /></td></tr>
<tr class="separator:a091ffc6a1424b2dd0a2dc2d4d962d1f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a108e98920aedd64e777f6f3d5b21fc05" id="r_a108e98920aedd64e777f6f3d5b21fc05"><td class="memItemLeft" align="right" valign="top"><a id="a108e98920aedd64e777f6f3d5b21fc05" name="a108e98920aedd64e777f6f3d5b21fc05"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>EXP_DIST</b></td></tr>
<tr class="memdesc:a108e98920aedd64e777f6f3d5b21fc05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Traveled distance that ROMI can go in [explore mode] S2_PATH only. <br /></td></tr>
<tr class="separator:a108e98920aedd64e777f6f3d5b21fc05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec3379bab683b2226f9e8fdf3324944b" id="r_aec3379bab683b2226f9e8fdf3324944b"><td class="memItemLeft" align="right" valign="top"><a id="aec3379bab683b2226f9e8fdf3324944b" name="aec3379bab683b2226f9e8fdf3324944b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>WALL1_YAW</b></td></tr>
<tr class="memdesc:aec3379bab683b2226f9e8fdf3324944b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The target angle to turn to avoid the first side of the wall. <br /></td></tr>
<tr class="separator:aec3379bab683b2226f9e8fdf3324944b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a430bdc79eb1235d753ccedb368c8ca" id="r_a3a430bdc79eb1235d753ccedb368c8ca"><td class="memItemLeft" align="right" valign="top"><a id="a3a430bdc79eb1235d753ccedb368c8ca" name="a3a430bdc79eb1235d753ccedb368c8ca"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>WALL2_YAW</b></td></tr>
<tr class="memdesc:a3a430bdc79eb1235d753ccedb368c8ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">The target angle to turn to avoid the second side of the wall. <br /></td></tr>
<tr class="separator:a3a430bdc79eb1235d753ccedb368c8ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75046f45b073cc5af8aa6f94b93ac1f8" id="r_a75046f45b073cc5af8aa6f94b93ac1f8"><td class="memItemLeft" align="right" valign="top"><a id="a75046f45b073cc5af8aa6f94b93ac1f8" name="a75046f45b073cc5af8aa6f94b93ac1f8"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>OLD_YAW</b></td></tr>
<tr class="memdesc:a75046f45b073cc5af8aa6f94b93ac1f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">The old angle before turning to avoid the wall. <br /></td></tr>
<tr class="separator:a75046f45b073cc5af8aa6f94b93ac1f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8272891a6d1739d83b5265071c160d4e" id="r_a8272891a6d1739d83b5265071c160d4e"><td class="memItemLeft" align="right" valign="top"><a id="a8272891a6d1739d83b5265071c160d4e" name="a8272891a6d1739d83b5265071c160d4e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>state</b></td></tr>
<tr class="memdesc:a8272891a6d1739d83b5265071c160d4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The current state of this motor task. <br /></td></tr>
<tr class="separator:a8272891a6d1739d83b5265071c160d4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab627445476bd8cb28bdc5086e4a7b96" id="r_aab627445476bd8cb28bdc5086e4a7b96"><td class="memItemLeft" align="right" valign="top"><a id="aab627445476bd8cb28bdc5086e4a7b96" name="aab627445476bd8cb28bdc5086e4a7b96"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>S0_INIT</b></td></tr>
<tr class="memdesc:aab627445476bd8cb28bdc5086e4a7b96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Init all required sensors and actuators. <br /></td></tr>
<tr class="separator:aab627445476bd8cb28bdc5086e4a7b96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bf7e9177df71a0debbb9fd1d5a42858" id="r_a0bf7e9177df71a0debbb9fd1d5a42858"><td class="memItemLeft" align="right" valign="top"><a id="a0bf7e9177df71a0debbb9fd1d5a42858" name="a0bf7e9177df71a0debbb9fd1d5a42858"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>S1_HUB</b></td></tr>
<tr class="memdesc:a0bf7e9177df71a0debbb9fd1d5a42858"><td class="mdescLeft">&#160;</td><td class="mdescRight">Motor hub that control the states base on sensor condition. <br /></td></tr>
<tr class="separator:a0bf7e9177df71a0debbb9fd1d5a42858"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88e1cd8d9d7507a00f75d58c1b94da85" id="r_a88e1cd8d9d7507a00f75d58c1b94da85"><td class="memItemLeft" align="right" valign="top"><a id="a88e1cd8d9d7507a00f75d58c1b94da85" name="a88e1cd8d9d7507a00f75d58c1b94da85"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>S2_PATH</b></td></tr>
<tr class="memdesc:a88e1cd8d9d7507a00f75d58c1b94da85"><td class="mdescLeft">&#160;</td><td class="mdescRight">ROMI follows the design path using 6 line sensors. <br /></td></tr>
<tr class="separator:a88e1cd8d9d7507a00f75d58c1b94da85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4a948955609a9f4c1db581bb9a7460b" id="r_ae4a948955609a9f4c1db581bb9a7460b"><td class="memItemLeft" align="right" valign="top"><a id="ae4a948955609a9f4c1db581bb9a7460b" name="ae4a948955609a9f4c1db581bb9a7460b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>S3_WALL1</b></td></tr>
<tr class="memdesc:ae4a948955609a9f4c1db581bb9a7460b"><td class="mdescLeft">&#160;</td><td class="mdescRight">ROMI meets the wall and turns left 90°, then go straight until not see the wall. <br /></td></tr>
<tr class="separator:ae4a948955609a9f4c1db581bb9a7460b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f63e6208b8e33cea7b28024fe4f5daa" id="r_a7f63e6208b8e33cea7b28024fe4f5daa"><td class="memItemLeft" align="right" valign="top"><a id="a7f63e6208b8e33cea7b28024fe4f5daa" name="a7f63e6208b8e33cea7b28024fe4f5daa"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>S3_WALL2</b></td></tr>
<tr class="memdesc:a7f63e6208b8e33cea7b28024fe4f5daa"><td class="mdescLeft">&#160;</td><td class="mdescRight">ROMI turns right 90° then goes straight untill not see the wall. <br /></td></tr>
<tr class="separator:a7f63e6208b8e33cea7b28024fe4f5daa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b14dfd1902f2227e698c04478c19a39" id="r_a5b14dfd1902f2227e698c04478c19a39"><td class="memItemLeft" align="right" valign="top"><a id="a5b14dfd1902f2227e698c04478c19a39" name="a5b14dfd1902f2227e698c04478c19a39"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>S3_WALL3</b></td></tr>
<tr class="memdesc:a5b14dfd1902f2227e698c04478c19a39"><td class="mdescLeft">&#160;</td><td class="mdescRight">ROMI turns right 90° then goes straight until pickup signal from the line sensor. <br /></td></tr>
<tr class="separator:a5b14dfd1902f2227e698c04478c19a39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e008a4b53ee220365fd12ee98233bde" id="r_a9e008a4b53ee220365fd12ee98233bde"><td class="memItemLeft" align="right" valign="top"><a id="a9e008a4b53ee220365fd12ee98233bde" name="a9e008a4b53ee220365fd12ee98233bde"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>S3_WALL4</b></td></tr>
<tr class="memdesc:a9e008a4b53ee220365fd12ee98233bde"><td class="mdescLeft">&#160;</td><td class="mdescRight">ROMI turns left 90° then go back to follow the line. <br /></td></tr>
<tr class="separator:a9e008a4b53ee220365fd12ee98233bde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ec81ef66bd726a171d6fe7a19db2603" id="r_a9ec81ef66bd726a171d6fe7a19db2603"><td class="memItemLeft" align="right" valign="top"><a id="a9ec81ef66bd726a171d6fe7a19db2603" name="a9ec81ef66bd726a171d6fe7a19db2603"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>S4_RETURNX</b></td></tr>
<tr class="memdesc:a9ec81ef66bd726a171d6fe7a19db2603"><td class="mdescLeft">&#160;</td><td class="mdescRight">ROMI facing to X axis and run forward until reach X &lt; 0.02 [m]. <br /></td></tr>
<tr class="separator:a9ec81ef66bd726a171d6fe7a19db2603"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a485d332be040a80dba0ee6b59af44e8f" id="r_a485d332be040a80dba0ee6b59af44e8f"><td class="memItemLeft" align="right" valign="top"><a id="a485d332be040a80dba0ee6b59af44e8f" name="a485d332be040a80dba0ee6b59af44e8f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>S4_RETURNY</b></td></tr>
<tr class="memdesc:a485d332be040a80dba0ee6b59af44e8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">ROMI facing to Y axis and run forward until reach Y &lt; 0.02 [m]. <br /></td></tr>
<tr class="separator:a485d332be040a80dba0ee6b59af44e8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af60665ca891d9615b8d88306a47390be" id="r_af60665ca891d9615b8d88306a47390be"><td class="memItemLeft" align="right" valign="top"><a id="af60665ca891d9615b8d88306a47390be" name="af60665ca891d9615b8d88306a47390be"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>S5_HOME</b></td></tr>
<tr class="memdesc:af60665ca891d9615b8d88306a47390be"><td class="mdescLeft">&#160;</td><td class="mdescRight">ROMI get back to the HOME position and pivot to celebrate. <br /></td></tr>
<tr class="separator:af60665ca891d9615b8d88306a47390be"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file implement a task that control ROMI motor base on input share from different task. </p>
<div class="image">
<img src="motor_task.png" alt=""/>
</div>
<pre class="fragment">A class for managing ROMI DC motor to run it through the course include following objective
    1. Following 0.75 inches width line with different pattern
    2. Go around the a 10 inches segment long square wall obstacle and get back to the line
    3. Stop at the end of the line
    4. Return the the original starting point
    
Attributes:
    
    Shares:
        SER_DIR (share): A share to set servo direction(ultrasonic sensor attached) from task_SER.py
        IMU_YAW (share): A share to get the yaw angle of the attached IMU from task_IMU.py
        ULS_DIS (share): A share to get the sensing distance from the ultrasonic sensor in task_ULS.py
        CLOSE   (share): A share to set blindfold condition from task_SER.py
    
    States:
        state (int): The current state of this motor task.
        S0_INIT (int): Init all required sensors and actuators (more detail below run() section) 
        S1_HUB (int): Motor hub that act as the brain to control the states base on sensor condition
        S2_PATH (int): ROMI follows the design path using 6 line sensors
        S3_WALL1 (int): ROMI meets the wall and turn left 90°, then goes straight until not see the wall then go to S3_WALL2
        S3_WALL2 (int): ROMI turn right 90°, then goes straight until not see the wall then go to S3_WALL3
        S3_WALL3 (int): ROMI turn right 90°, then goes straight untill see the black line
        S3_WALL4 (int): ROMI turn left 90°, then set flag WALL = 1 and go back to S1_HUB
        S4_RETURNX (int): ROMI facing to X axis and run forward until reach X &lt; 0.02 [m]
        S4_RETUNRY (int): ROMI facing to Y axis and run forward until reach Y &lt; 0.02 [m]
        S5_HOME (int): ROMI get back to the HOME position and pivot to celebrate
    
    Others:
        X (float): variable that continuosly store updated X coordinate of ROMI
        Y (float): variable that continuosly store updated Y coordinate of ROMI
        EXP_DIST (float): traveled distance that ROMI can go in [explore mode] in S2_PATH state (for detecting TARGET and HOME position)
        WALL (int): Wall flag that turn to 1 if ROMI pass the wall obstacle
        TARGET (int): Target flag that turn to 1 if ROMI reach the target
        HOME (int): Home flag that turn to 1 if ROMI successfully return the home position 
        OLD_YAW (float): Variable that store the old angle before turning to avoid the wall
        WALL1_YAW (float): Variable that store the target angle to turn to avoid the first side of the wall
        WALL2_YAW (float): Variable that store the target angle to turn to avoid the second side of the wall

Methods:
    __init__(self, ULS_DIS): Initializes the ULSTask instance.
    run(self): Runs the motor task in a loop, handling all sensors and actuators appropriately.
    check_sensor(L2, L1, M, R1, R2, H): take the status of 6 line sensor then return the appropriate [case]
    update_speed(case): take the [case] variable then return the appropriate yaw rate speed [rad/s] and linear speed [m/s] 
    DC_speed_cal(y, v): take the yaw rate speed [rad/s] and linear speed [m/s] to process 
                        and return the appropriate angular speed [rad/s] for both right and left wheels 
    check_return(X, Y, state): take the global location X and Y of ROMI as well as the current state, return the new state and HOME flag when X and Y &lt; 0.02 [m] 
</pre> </div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a56c3f12f721ec1d5d83378d95dcb96a1" name="a56c3f12f721ec1d5d83378d95dcb96a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56c3f12f721ec1d5d83378d95dcb96a1">&#9670;&#160;</a></span>run()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">task_MOT.MotorTask.run </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Run and manage ROMI's DC motor to run it through the course using the data from sensors to control the actuators

    STATE    NAME                             DESCRIPTIOM
      0      INIT      This state init the [2] DC motor, [2] encoders, [6] line sensor, [2] PID controller, [1] ADC pin for calibrate mode 
      
      1      HUB       This state act as a hub to decide which state to go base on condtion
                       The logic for this task is descibe as following:
                          - if [in the calibration mode] stop and set all flags to 0
                          - else if [HOME == 1 and TARGET == 1], state = S5_HOME
                          - else if [no obstacle ditected and TARGET == 0], state = S2_PATH
                          - else if [obstacle dictected and TARGET == 0 and WALL == 0], state = S3_WALL1
                          - else if [TARGET == 1 and HOME == 0]: run check_return --&gt; state = S4_RETURNX if X &lt; 0.02 [m]
                                                                                      state = S4_RETURNY if Y &lt; 0.02 [m]
      2      PATH      This state control ROMI to follow the line with condition from the line sensor
                       The logic for this task is descibe as following:
                           - read the line sensors status
                           - check the sensors status for [case] --&gt; check_sensor()
                               if [case == "explore"] and EXP_DIST &gt; 0.15, case = "stop"
                           - use [case] for finding the yaw rate and linear speed --&gt;  update_speed()
                           - use the yaw rate and linear speed to calculate both wheels angular speed --&gt; DC_speed_cal()
                           - update speed for ROMI's 2 DC motor and return S1_HUB 
                           
      3a     WALL1      This state turn ROMI left for 90° and turn the first servo right 90° then go straight until not see the wall
      3b     WALL2      This state turn ROMI right for 90° and keep the first servo the same angle then go straight until not seeing the wall
      3c     WALL3      This state turn ROMI right for 90° then go straigh until pickup line sensor signal
      3d     WALL4      This state tune ROMI left for 90° then set flag WALL = 1 and go back to S1_HUB
      4x     RETURNX    This state turn ROMI to 180° from the original angle from stating point then:
                           - if [HOME == 0 and abs(X) &lt; 0.02] 
                               if X &gt; 0 then go forward and X &lt; 0 backup
      4y     RETURNY    This state turn ROMI to 90° from the original angle from stating point then:
                           - if [HOME == 0 and abs(Y) &lt; 0.02] 
                               if Y &gt; 0 then go forward and Y &lt; 0 backup
      5      HOME       ROMI at home position, pivoting and put the "money mask" [2nd servo] on
</pre> 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="task___m_o_t_8py.html">task_MOT.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
